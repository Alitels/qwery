/*!
  * qwery.js - copyright @dedfat
  * original inspiration: http://simonwillison.net/2003/Mar/25/getElementsBySelector/
  * https://github.com/polvero/qwery
  * Follow our software http://twitter.com/dedfat
  * MIT License
  */

!function(a,b){function i(a,d){if(!b.getElementsByTagName)return[];d=d||document;if(b.querySelectorAll)return c(d.querySelectorAll(a),0);var e=[],g=f(a.split(",")).map(function(a){return h(a)});f(g).each(function(a){e=e.concat(a)});return e}function h(a){var c=a.split(" "),e,f,h,i,j,k,l,m,n,o,p,q,r=[b];for(i=0,l=c.length;i<l;i++){token=c[i].replace(/^\s+|\s+$/g,"");if(token.indexOf("#")>-1){e=token.split("#"),f=e[0];var s=b.getElementById(e[1]);if(f&&s.nodeName.toLowerCase()!=f)return[];r=[s];continue}if(token.indexOf(".")>-1){e=token.split("."),f=e[o=0],f=f||"*",n=[];for(h=0,m=r.length;h<m;h++){p=f=="*"?d(r[h]):r[h].getElementsByTagName(f);for(j=0,k=p.length;j<k;j++)n[o++]=p[j]}r=[],q=0;for(k=0,m=n.length;k<m;k++)n[k].className&&n[k].className.match(new RegExp("(?:^|\\s+)"+e[1]+"(?:\\s+|$)"))&&(r[q++]=n[k]);continue}if(token.match(/^(\w*)\[(\w+)([=~\|\^\$\*]?)=?"?([^\]"]*)"?\]$/)){f=RegExp.$1;var t=RegExp.$2,u=RegExp.$3,v=RegExp.$4;f||(f="*"),n=[],o=0;for(h=0;h<r.length;h++){f=="*"?p=d(r[h]):p=r[h].getElementsByTagName(f);for(j=0;j<p.length;j++)n[o++]=p[j]}r=[],q=0;var w=g[u]||g[""];for(k=0;k<n.length;k++)w(n[k],t,v)&&(r[q++]=n[k]);continue}f=token,n=[],o=0;for(h=0;h<r.length;h++){p=r[h].getElementsByTagName(f);for(j=0;j<p.length;j++)n[o++]=p[j]}r=n}return r}function f(a){return new e(a)}function e(a){this.obj=c(a)}function d(a){return a.all?a.all:a.getElementsByTagName("*")}function c(a){return Array.prototype.slice.call(a,0)}e.prototype={each:function(a){for(var b=0;b<this.obj.length;b++)a.call(this.obj[b],this.obj[b],b,this.obj);return this},map:function(a){var b=[];for(var c=0;c<this.obj.length;c++)b[c]=a.call(this.obj[c],this.obj[c],c,this.obj);return b}};var g={"=":function(a,b,c){return a.getAttribute(b)==c},"~":function(a,b,c){return a.getAttribute(b).match(new RegExp("\\b"+c+"\\b"))},"|":function(a,b,c){return a.getAttribute(b).match(new RegExp("^"+c+"-?"))},"^":function(a,b,c){return a.getAttribute(b).indexOf(c)===0},$:function(a,b,c){return a.getAttribute(b).lastIndexOf(c)==a.getAttribute(b).length-c.length},"*":function(a,b,c){return a.getAttribute(b).indexOf(c)>-1},"":function(a,b){return a.getAttribute(b)}},j=a.qwery;i.noConflict=function(){a.qwery=j;return this},a.qwery=i}(this,document)